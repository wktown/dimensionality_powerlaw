INFO:model_tools.activations.core.ActivationsExtractorHelper:Running stimuli
-0.2
0.25997624946025255
0.9994461658110113
-0.2

activations:   0%|          | 0/10048 [00:00<?, ?it/s]INFO:model_tools.activations.core.ActivationsExtractorHelper:Running stimuli


activations:   0%|          | 0/1024 [00:00<?, ?it/s][A

activations:   6%|â–‹         | 64/1024 [00:01<00:20, 46.71it/s][A

activations:  12%|â–ˆâ–Ž        | 128/1024 [00:02<00:21, 42.18it/s][A

activations:  19%|â–ˆâ–‰        | 192/1024 [00:04<00:19, 42.08it/s][A

activations:  25%|â–ˆâ–ˆâ–Œ       | 256/1024 [00:06<00:18, 40.67it/s][A

activations:  31%|â–ˆâ–ˆâ–ˆâ–      | 320/1024 [00:07<00:17, 40.29it/s][A

activations:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 384/1024 [00:09<00:16, 38.40it/s][A

activations:  44%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 448/1024 [00:11<00:15, 37.64it/s][A

activations:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 512/1024 [00:13<00:14, 36.40it/s][A

activations:  56%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹    | 576/1024 [00:15<00:12, 35.99it/s][A

activations:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 640/1024 [00:17<00:11, 34.70it/s][A

activations:  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 704/1024 [00:18<00:09, 34.24it/s][A

activations:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 768/1024 [00:21<00:07, 33.03it/s][A

activations:  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ– | 832/1024 [00:23<00:06, 31.79it/s][A

activations:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 896/1024 [00:25<00:04, 30.64it/s][A

activations:  94%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 960/1024 [00:27<00:02, 30.15it/s][A

activations: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1024/1024 [00:29<00:00, 31.54it/s][A
activations: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1024/1024 [00:29<00:00, 34.65it/s]
INFO:model_tools.activations.core.ActivationsExtractorHelper:Packaging into assembly


layer packaging:   0%|          | 0/1 [00:00<?, ?it/s][A

layer packaging: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.52s/it][A
layer packaging: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:01<00:00,  1.52s/it]
imagenet dict [0] shape
(1000, 1000, 24, 24)


layer principal components:   0%|          | 0/1 [00:00<?, ?it/s][A

layer principal components: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:01<00:00, 61.85s/it][A
layer principal components: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [01:01<00:00, 61.85s/it]

activations:   0%|          | 0/10048 [02:04<?, ?it/s]
Traceback (most recent call last):
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/home/wtownle1/dimensionality_powerlaw/scripts/compute_eigenspectra.py", line 96, in <module>
    main(dataset=args.dataset, data_dir=args.data_dir, pooling=args.pooling, seed=args.seed, grayscale=args.grayscale, debug=args.debug)
  File "/home/wtownle1/dimensionality_powerlaw/utils.py", line 29, in wrap
    result = func(*args, **kwargs)
  File "/home/wtownle1/dimensionality_powerlaw/scripts/compute_eigenspectra.py", line 34, in main
    eigspec.fit(layers)
  File "/home/wtownle1/dimensionality_powerlaw/custom_model_tools/eigenspectrum.py", line 68, in fit
    image_transform_name=transform_name)
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/site-packages/result_caching/__init__.py", line 223, in wrapper
    result = function(**reduced_call_args)
  File "/home/wtownle1/dimensionality_powerlaw/custom_model_tools/eigenspectrum.py", line 213, in _fit
    activations = self._extractor(image_paths, layers=[layer])
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/site-packages/model_tools/activations/pytorch.py", line 41, in __call__
    return self._extractor(*args, **kwargs)
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/site-packages/model_tools/activations/core.py", line 43, in __call__
    return self.from_paths(stimuli_paths=stimuli, layers=layers, stimuli_identifier=stimuli_identifier)
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/site-packages/model_tools/activations/core.py", line 73, in from_paths
    activations = fnc(layers=layers, stimuli_paths=reduced_paths)
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/site-packages/model_tools/activations/core.py", line 85, in _from_paths
    layer_activations = self._get_activations_batched(stimuli_paths, layers=layers, batch_size=self._batch_size)
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/site-packages/model_tools/activations/core.py", line 135, in _get_activations_batched
    batch_activations = hook(batch_activations)
  File "/home/wtownle1/dimensionality_powerlaw/custom_model_tools/layerPCA_modified.py", line 124, in __call__
    multithread=os.getenv('MT_MULTITHREAD', '1') == '1')
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/site-packages/model_tools/activations/core.py", line 247, in change_dict
    results = map_fnc(apply_change, d.items())
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/multiprocessing/pool.py", line 268, in map
    return self._map_async(func, iterable, mapstar, chunksize).get()
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/multiprocessing/pool.py", line 657, in get
    raise self._value
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/multiprocessing/pool.py", line 121, in worker
    result = (True, func(*args, **kwds))
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/multiprocessing/pool.py", line 44, in mapstar
    return list(map(*args))
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/site-packages/model_tools/activations/core.py", line 244, in apply_change
    values = change_function(values) if not keep_name else change_function(layer, values)
  File "/home/wtownle1/dimensionality_powerlaw/custom_model_tools/layerPCA_modified.py", line 88, in apply_pca
    Uc, Sc, VTc = np.linalg.svd(activations_new, full_matrices=False)
  File "<__array_function__ internals>", line 6, in svd
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/site-packages/numpy/linalg/linalg.py", line 1641, in svd
    _assert_stacked_2d(a)
  File "/home/wtownle1/env_dim/dim-powerlaw/lib/python3.7/site-packages/numpy/linalg/linalg.py", line 197, in _assert_stacked_2d
    'at least two-dimensional' % a.ndim)
numpy.linalg.LinAlgError: 1-dimensional array given. Array must be at least two-dimensional
not modified
pca eigenvalues:
(1000, 576000)
activations shape
(64, 576000)
